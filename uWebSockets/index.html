<html>
<header><title>This is title</title></header>
<body>
<div id="hero"><<p>Hello world</p></div>
<div id="button_panel">
    <input id="myInput" value="Type your input here..">
<!--    <button id="myBtn" onclick="javascript:alert('Hello World!')">Button</button>-->
    <button type="button" id="myBtn" onclick="myFunction()">Try it</button>
</div>

<p><img src="http://localhost:7777"></img></p>
<div id="content">Message Received: </div>
<div id="epoch">Server time: </div>
</body>
</html>

<script>

    var ws = new WebSocket("ws://127.0.0.1:13049");
    var connected = false;

    ws.onopen = function(event) {
        console.log("Connected");
        connected = true;
    };

    ws.onclose = function(event){
      connected = false;
    };

    ws.onmessage = function(event){
        var msg = JSON.parse(event.data);
        console.log(msg.message)
        // console.log("I got  amessage");
        // console.log(event.data);
        if (msg["message"] !== undefined){
            document.getElementById("content").innerHTML = "message Received: " + msg.message;
        }
        if (msg["epoch"] !== undefined){
            document.getElementById("epoch").innerHTML = "Server time: " + msg.epoch;
        }

    };

    function myFunction(){
        console.log("button clicked");
        if (connected){
            ws.send("the button was clicked\n");
        }
    }

    var input = document.getElementById("myInput");
    input.addEventListener("keyup", function(event) {
        if (event.keyCode === 13) {
            event.preventDefault();
            // do something with data
            console.log(input.value);
            if (connected){
                ws.send(input.value);
            }
            input.value = "";
            // document.getElementById("myBtn").click();
        }
    });


</script>